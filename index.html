<!DOCTYPE html>
<html>
<head>
    <title>mysterious space</title>
    <meta charset="UTF-8">
    <style>
        /* 隐藏所有内容 */
        body {
            margin: 0;
            overflow: hidden;
        }

        /* 背景视频容器 */
        #background-video {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%;
            min-height: 100%;
            z-index: -1;
        }

        /* 背景图片容器 */
        #background-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://example.com/secret-bg.jpg') no-repeat center center;
            background-size: cover;
            z-index: -2;
        }

        /* 文字内容 */
        .content {
            position: relative;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            font-family: 'Arial', sans-serif;
        }

        /* 隐藏iframe */
        #secret-frame {
            display: none;
        }
    </style>
</head>
<body>
    <!-- 背景视频 -->
    <video autoplay muted loop id="background-video">
        <source src="https://m.ccw.site/creator-college/videos/a111433b3eeed4f6464c033e23f57e46.mp4" type="ideo/mp4">
    </video>

    <!-- 背景图片 -->
    <div id="background-image"></div>

    <!-- 文字内容 -->
    <div class="content">
        <h1 style="font-size: 3em;">中转页</h1>
        <p style="font-size: 1.2em;">...</p>
    </div>

    <!-- 隐藏的API调用 -->
    <iframe id="secret-frame" title="nothing"></iframe>

<script>
// 配置参数
const SECRET_KEY = "g@nd1_2024";

// 解密函数
function xorDecrypt(base64Str) {
    try {
        const encrypted = Uint8Array.from(atob(base64Str), c => c.charCodeAt(0));
        const keyBytes = new TextEncoder().encode(SECRET_KEY);
        const decrypted = new Uint8Array(encrypted.length);
        
        for (let i = 0; i < encrypted.length; i++) {
            decrypted[i] = encrypted[i] ^ keyBytes[i % keyBytes.length];
        }
        return new TextDecoder().decode(decrypted).trim();
    } catch (e) {
        console.error('解密失败:', e);
        return null;
    }
}

// 初始化处理
function init() {
    const params = new URLSearchParams(window.location.search);
    const frame = document.getElementById('secret-frame');

    try {
        // 解密参数
        const email = xorDecrypt(params.get('b'));
        const code = xorDecrypt(params.get('a'));

        // 静默验证
        if (!email || !/^\w+@\w+\.\w+$/.test(email)) throw new Error('无效参数');
        if (!code || !/^\d{6}$/.test(code)) throw new Error('无效参数');

        // 构造API请求
        const apiUrl = new URL('https://glowguide.space/api/email.php');
        apiUrl.searchParams.set('to_email', email);
        apiUrl.searchParams.set('to_name', '你');
        apiUrl.searchParams.set('subject', '验证码');
        apiUrl.searchParams.set('body', `这是一封验证码邮件，验证码${code}，2分钟内有效`);
        apiUrl.searchParams.set('from_name', '邮箱验证码');
        // 静默发送请求
        frame.src = apiUrl.href;

        // 请求状态监控
        frame.onload = () => console.log('API调用成功');
        frame.onerror = () => console.warn('API调用失败');

    } catch (error) {
        console.error('处理失败:', error.message);
    }
}

// 启动处理流程
document.addEventListener('DOMContentLoaded', init);
    window.addEventListener('load', () => {
    // 添加视觉反馈
    document.body.style.background = '#1a1a1a';
    document.body.innerHTML = `
        <div style="color: white; text-align: center; padding: 20px;">
            <p>操作已完成，窗口将在3秒后关闭...</p>
            <button onclick="safeCloseWindow()" 
                style="padding: 10px 20px; background: #555; border: none; color: white;">
                立即关闭
            </button>
        </div>
    `;

    // 自动关闭倒计时
    setTimeout(safeCloseWindow, 3000);
});
</script>
</body>
</html>
